---
title: Configuración
description: Configura el Indexador de Bitcoin para un rendimiento óptimo y personaliza la configuración del metaprotocolo.
---
## Archivo de configuración

El Indexador de Bitcoin utiliza un archivo de configuración TOML para controlar todos los aspectos de la operación. Cree el archivo de configuración:

```terminal
$ nano ~/bitcoin-indexer/bitcoin-indexer/bitcoin-indexer-config.toml
```

## Ejemplo de configuración completa

```toml title="bitcoin-indexer-config.toml"
[storage]
# Path to RocksDB data directory
working_dir = "/home/bitcoin-indexer/bitcoin-indexer/rocksdb-chainstate"

[metrics]
# Enable Prometheus metrics
enabled = true
prometheus_port = 9153

[ordinals.db]
# PostgreSQL connection for Ordinals data
database = "ordinals"
host = "localhost"
port = 5432
username = "postgres"
password = "postgres"

[ordinals.meta_protocols.brc20]
# Enable BRC-20 indexing within Ordinals
enabled = true
lru_cache_size = 10000

[ordinals.meta_protocols.brc20.db]
# Separate database for BRC-20 data
database = "brc20"
host = "localhost"
port = 5432
username = "postgres"
password = "postgres"

[runes]
# LRU cache for Runes performance
lru_cache_size = 10000

[runes.db]
# PostgreSQL connection for Runes data
database = "runes"
host = "localhost"
port = 5432
username = "postgres"
password = "postgres"

[bitcoind]
# Bitcoin Core connection settings
network = "mainnet"
rpc_url = "http://127.0.0.1:8332"
rpc_username = "user"
rpc_password = "password"
zmq_url = "tcp://0.0.0.0:18543"

[resources]
# Resource allocation
ulimit = 2048
cpu_core_available = 6
memory_available = 16
bitcoind_rpc_threads = 6
bitcoind_rpc_timeout = 15
```

## Secciones de configuración

### Configuración de almacenamiento

Controla dónde el indexador almacena el estado de la blockchain:

```toml
[storage]
working_dir = "/path/to/rocksdb-chainstate"
# Optional: Set RocksDB specific options
rocksdb_max_open_files = 10000
rocksdb_cache_size = "8GB"
```

:::callout
### Rendimiento del almacenamiento

Utilice almacenamiento NVMe rápido para el directorio de trabajo. El indexador realiza muchas lecturas/escrituras aleatorias durante la operación.
:::

### Conexiones de base de datos

Cada metaprotocolo puede usar una base de datos separada para aislamiento:

```toml
[ordinals.db]
database = "ordinals"
host = "localhost"
port = 5432
username = "postgres"
password = "postgres"
# Optional connection pool settings
max_connections = 50
min_connections = 10
connection_timeout = 30
```

### Conexión de nodo Bitcoin

Configura cómo el indexador se conecta a tu nodo de Bitcoin:

```toml
[bitcoind]
network = "mainnet"  # or "testnet", "regtest"
rpc_url = "http://127.0.0.1:8332"
rpc_username = "user"
rpc_password = "password"
zmq_url = "tcp://0.0.0.0:18543"
# Optional: Custom RPC timeout
rpc_timeout = 30
```

### Asignación de recursos

Optimiza el rendimiento según tu hardware:

```toml
[resources]
# File descriptor limit
ulimit = 2048

# CPU cores to use for indexing
cpu_core_available = 6

# Memory in GB
memory_available = 16

# Bitcoin RPC connection pool
bitcoind_rpc_threads = 6
bitcoind_rpc_timeout = 15
```

### Configuración específica del metaprotocolo

#### Configuración de ordinales

```toml
[ordinals]
# Start indexing from specific height (optional)
start_block = 767430

# Enable inscription number calculation
track_numbers = true

# Cursed inscription handling
index_cursed = true

[ordinals.meta_protocols.brc20]
enabled = true
# Cache size for BRC-20 balance calculations
lru_cache_size = 10000
# Track all operations or just valid ones
index_invalid_operations = false
```

#### Configuración de runas

```toml
[runes]
# LRU cache for rune entries
lru_cache_size = 10000

# Start block for runes (mainnet activation)
start_block = 840000

# Index unspendable runes
index_unspendable = true
```

### Configuración de API

Configurar el servidor de API REST:

```toml
[api]
# API server settings
enabled = true
port = 3000
host = "0.0.0.0"

# CORS settings
cors_enabled = true
cors_origins = ["*"]

# Rate limiting
rate_limit_enabled = true
rate_limit_requests_per_minute = 60

# API key authentication
require_auth = false
api_keys = ["your-api-key-here"]
```

### Configuración de monitoreo

Habilitar métricas y monitoreo:

```toml
[metrics]
enabled = true
prometheus_port = 9153

# Log settings
[logging]
level = "info"  # debug, info, warn, error
format = "json"  # json or pretty
directory = "/home/bitcoin-indexer/bitcoin-indexer/logs"
max_size = "100MB"
max_backups = 10
```

## Ajuste de rendimiento

### Para indexación de alto rendimiento

```toml
[resources]
cpu_core_available = 16
memory_available = 32
bitcoind_rpc_threads = 16

[storage]
rocksdb_cache_size = "16GB"
rocksdb_max_open_files = 20000

[ordinals.db]
max_connections = 100
```

### Para recursos limitados

```toml
[resources]
cpu_core_available = 4
memory_available = 8
bitcoind_rpc_threads = 4

[storage]
rocksdb_cache_size = "2GB"
rocksdb_max_open_files = 5000

[ordinals.db]
max_connections = 20
```

## Variables de entorno

Los valores de configuración pueden ser anulados con variables de entorno:

```bash
# Override database password
export BITCOIN_INDEXER_ORDINALS_DB_PASSWORD="secure_password"

# Override RPC credentials
export BITCOIN_INDEXER_BITCOIND_RPC_USERNAME="myuser"
export BITCOIN_INDEXER_BITCOIND_RPC_PASSWORD="mypass"

# Override API port
export BITCOIN_INDEXER_API_PORT="8080"
```

## Validar configuración

Prueba tu configuración antes de comenzar:

```terminal
$ bitcoin-indexer validate --config-path=~/bitcoin-indexer/bitcoin-indexer/bitcoin-indexer-config.toml
[32m✓[0m Configuration valid
[32m✓[0m Bitcoin node reachable
[32m✓[0m PostgreSQL databases accessible
[32m✓[0m Storage directory writable
```
