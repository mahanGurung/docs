---
title: Sincronización completa
sidebarTitle: Sincronización completa
description: Ejecutar el Indexador de Bitcoin desde cero.
isNew: true
---
import { ArrowRight, Check } from 'lucide-react';

## Lo que aprenderás

:::objectives
* Configurar e inicializar el Indexador de Bitcoin
* Ejecutar el indexador desde cero
* Monitorear el progreso de indexación de manera efectiva
:::

:::prerequisites
* Bitcoin Core nodo ejecutándose con `txindex=1`
* PostgreSQL ejecutándose con bases de datos creadas
* Espacio de almacenamiento suficiente
:::

:::callout
### Archivo bootstrap recomendado

Si aún no lo has hecho, considera [arranque inicial desde archivos](/tools/bitcoin-indexer/archive-bootstrap) para ahorrar días de tiempo de indexación.
:::

## Iniciar servicios de indexación

El Indexador de Bitcoin ejecuta servicios separados para cada metaprotocolo. Navega a tu directorio del indexador:

```terminal
$ cd ~/bitcoin-indexer/bitcoin-indexer
```

### Ordinales de Índice (incluye BRC-20)

```terminal
$ ./target/release/bitcoin-indexer ordinals service start --config-path=bitcoin-indexer-config.toml
```

### Runas de Índice

En una terminal separada:

```terminal
$ ./target/release/bitcoin-indexer runes service start --config-path=bitcoin-indexer-config.toml
```

:::callout
type: info

### Compilando desde el código fuente

Si está descargando una versión de nuestro extremo, ejecute `cargo build --release` después de navegar a la carpeta para compilar el proyecto. Este paso es necesario para usar `/target/release/bitcoin-indexer` para iniciar servicios.
:::

## Monitorear el progreso de indexación

### Revisar los registros del servicio

El indexador genera información detallada sobre el progreso:

```terminal
$ tail -f ~/bitcoin-indexer/bitcoin-indexer/ordinals.log
```

### Consultar el estado del indexador a través de la API

Una vez que el servidor API se inicia (generalmente después de unos pocos bloques):

```terminal
$ curl http://localhost:3000/ordinals/v1/status
{
  "block_height": 819600,
  "inscriptions_indexed": 52342567,
  "latest_inscription_number": 52342567,
  "sync_percentage": 99.93,
  "blocks_behind": 523
}
```

## Gestión de servicios

### Detener servicios de manera controlada

```terminal
$ ps aux | grep bitcoin-indexer
```

### Reiniciar después de la interrupción

El indexador se reanuda automáticamente desde el último bloque procesado:

```terminal
$ ./target/release/bitcoin-indexer ordinals service start --config-path=bitcoin-indexer-config.toml
```

## Configuración del servicio systemd

Para implementaciones de producción, utilice systemd para gestionar servicios:

### Crear servicio de Ordinales

```bash title="/etc/systemd/system/bitcoin-indexer-ordinals.service"
[Unit]
Description=Bitcoin Indexer - Ordinals Service
After=network.target postgresql.service bitcoind.service

[Service]
Type=simple
User=bitcoin-indexer
WorkingDirectory=/home/bitcoin-indexer/bitcoin-indexer
ExecStart=/home/bitcoin-indexer/bitcoin-indexer/target/release/bitcoin-indexer ordinals service start --config-path=bitcoin-indexer-config.toml
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
```

### Crear servicio de Runas

```bash title="/etc/systemd/system/bitcoin-indexer-runes.service"
[Unit]
Description=Bitcoin Indexer - Runes Service
After=network.target postgresql.service bitcoind.service

[Service]
Type=simple
User=bitcoin-indexer
WorkingDirectory=/home/bitcoin-indexer/bitcoin-indexer
ExecStart=/home/bitcoin-indexer/bitcoin-indexer/target/release/bitcoin-indexer runes service start --config-path=bitcoin-indexer-config.toml
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
```

### Habilitar e iniciar servicios

```terminal
$ sudo systemctl daemon-reload
$ sudo systemctl enable bitcoin-indexer-ordinals bitcoin-indexer-runes
$ sudo systemctl start bitcoin-indexer-ordinals bitcoin-indexer-runes
$ sudo systemctl status bitcoin-indexer-ordinals
```

## Optimización del rendimiento

### Durante la sincronización inicial

Optimizar el rendimiento durante la puesta al día:

```toml title="bitcoin-indexer-config.toml"
[resources]
# Use more cores during initial sync
cpu_core_available = 12
bitcoind_rpc_threads = 10
```

### Después de alcanzar la punta de la cadena

Reducir el uso de recursos para la operación en estado estable:

```toml
[resources]
# Reduce for normal operation
cpu_core_available = 4
bitcoind_rpc_threads = 4
```

## Verificar la indexación exitosa

### Verificar puntos finales de API

Prueba que las APIs estén devolviendo datos:

```terminal -o
$ curl http://localhost:3000/ordinals/v1/inscriptions/0
```

## Próximos pasos

:::next-steps
* [Archivos de Hiro](/tools/bitcoin-indexer/archive-bootstrap): Salta semanas de indexación al iniciar desde los archivos preindexados de Hiro.
* [Configuración avanzada](/tools/bitcoin-indexer/configuration): Configura el Indexador de Bitcoin para un rendimiento óptimo y personaliza la configuración del metaprotocolo.
:::
