---
title: Desplegando tus contratos
sidebarTitle: Despliegue de contratos
description: Clarinet proporciona herramientas de implementaci√≥n completas para ayudarte a mover tus contratos desde el desarrollo local a las redes de producci√≥n. Ya sea que est√©s probando en devnet, preparando en testnet o lanzando en mainnet, Clarinet simplifica todo el proceso de implementaci√≥n.
---
## Generando planes de despliegue

Los planes de despliegue son archivos YAML que definen exactamente c√≥mo se desplegar√°n tus contratos. Especifican el orden, la configuraci√≥n y los detalles de red para cada contrato, asegurando despliegues reproducibles en todos los entornos. Para crear un plan de despliegue para cualquier red, ejecuta el siguiente comando:

```terminal
$ clarinet deployments generate --testnet
[32mAnalyzing contracts...[0m
[32mCalculating deployment costs...[0m
[32mGenerating deployment plan[0m
[32mCreated file[0m [1mdeployments/default.testnet-plan.yaml[0m
```

Esto crea un plan de despliegue basado en la configuraci√≥n de su proyecto:

```yaml deployments/default.devnet-plan.yaml
---
id: 0
name: Devnet deployment
network: devnet
stacks-node: "http://localhost:20443"
bitcoin-node: "http://devnet:devnet@localhost:18443"
plan:
  batches:
    - id: 0
      transactions:
        - contract-publish:
            contract-name: counter
            expected-sender: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM
            cost: 6940
            path: contracts/counter.clar
            anchor-block-only: true
            clarity-version: 2
      epoch: "2.5"
```

### Estructura del plan de despliegue

Componentes clave de un plan de despliegue:

| Campo | Descripci√≥n |
|-------|-------------|
| `id` | Identificador √∫nico para el despliegue |
| `name` | Nombre de implementaci√≥n legible por humanos |
| `network` | Red objetivo (devnet/testnet/mainnet) |
| `stacks-node` | Punto final RPC para el nodo Stacks |
| `bitcoin-node` | Punto final RPC para el nodo de Bitcoin |
| `plan.batches` | Matriz de lotes de implementaci√≥n |

### Especificaciones de despliegue

El comportamiento de implementaci√≥n se configura en dos lugares:

**Configuraci√≥n del proyecto** (`Clarinet.toml`):

* Versi√≥n de Clarity para contratos
* Dependencias contractuales
* Requisitos de √©poca

**Configuraci√≥n de red** (`settings/<Network>.toml`):

* Detalles y saldos de la cuenta
* Puntos finales de red
* Cuentas de implementaci√≥n personalizadas

Ejemplo de configuraci√≥n de red:

```toml settings/Testnet.toml
[network]
name = "testnet"
deployment_fee_rate = 10

[accounts.deployer]
mnemonic = "<YOUR TESTNET MNEMONIC>"
balance = 100_000_000_000_000
derivation = "m/44'/5757'/0'/0/0"
```

## Trabajando con requisitos contractuales

Su proyecto puede hacer referencia a contratos que ya existen en la blockchain. Esto es especialmente √∫til para implementar rasgos estandarizados.

### A√±adiendo requisitos

Agregar dependencias de contratos externos:

```terminal
$ clarinet requirements add SP2PABAF9FTAJYNFZH93XENAJ8FVY99RRM50D2JG9.nft-trait
[32mAdded requirement[0m SP2PABAF9FTAJYNFZH93XENAJ8FVY99RRM50D2JG9.nft-trait
[33mUpdated[0m [1mClarinet.toml[0m
```

Esto actualiza la configuraci√≥n de tu proyecto:

```toml Clarinet.toml
[project]
name = "my-nft-project"
requirements = [
  { contract_id = "SP2PABAF9FTAJYNFZH93XENAJ8FVY99RRM50D2JG9.nft-trait" }
]
```

Al implementar, Clarinet autom√°ticamente:

* Descarga el contrato a trav√©s de la API de Stacks
* Reasigna el principal a una cuenta local para devnet
* Garantiza que el requisito est√© disponible antes de desplegar tus contratos

## Implementaci√≥n en diferentes redes

<Tabs defaultValue="devnet" className="w-full">
  <TabsList className="h-auto p-0 bg-transparent">
    <TabsTrigger value="devnet" className="data-[state=active]:border-b-2 data-[state=active]:border-primary border-b-2 border-border/50 pb-2 px-4 bg-transparent hover:bg-transparent rounded-none text-muted-foreground data-[state=active]:text-primary font-fono [&>p]:m-0">
      Devnet
    </TabsTrigger>

    <TabsTrigger value="testnet" className="data-[state=active]:border-b-2 data-[state=active]:border-primary border-b-2 border-border/50 pb-2 px-4 bg-transparent hover:bg-transparent rounded-none text-muted-foreground data-[state=active]:text-primary font-fono [&>p]:m-0">
      Testnet
    </TabsTrigger>

    <TabsTrigger value="red principal" className="data-[state=active]:border-b-2 data-[state=active]:border-primary border-b-2 border-border/50 pb-2 px-4 bg-transparent hover:bg-transparent rounded-none text-muted-foreground data-[state=active]:text-primary font-fono [&>p]:m-0">
      Mainnet
    </TabsTrigger>
  </TabsList>

  <TabsContent value="devnet" className="mt-4">
    **Implementaci√≥n r√°pida para desarrollo local**

    Devnet despliega autom√°ticamente los contratos cuando se inicia:

    ```terminal
    $ clarinet devnet start
    [32mStarting devnet...[0m
    [32mDeploying contracts...[0m
    [90mDeploying[0m counter.clar        [32m‚úì[0m  ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM.counter
    [90mDeploying[0m token.clar          [32m‚úì[0m  ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM.token
    ```

    Para el despliegue manual a una devnet en ejecuci√≥n:

    ```terminal
    $ clarinet deployments apply --devnet
    ```

    Ver [desarrollo local](/tools/clarinet/local-development) para una configuraci√≥n detallada de devnet.
  </TabsContent>

  <TabsContent value="testnet" className="mt-4">
    :::callout
    ### Requisitos previos

    Antes de implementar en la red de pruebas:

    * Obt√©n STX de testnet desde el [grifo](https://explorer.hiro.so/sandbox/faucet?chain=testnet)
    * Configura tu cuenta en `settings/Testnet.toml`
    * Validar contratos con `clarinet check`
    :::

    **Generar plan de despliegue con estimaci√≥n de costos**:

    ```terminal
    $ clarinet deployments generate --testnet --medium-cost
    ```

    **Implementar contratos**:

    ```terminal
    $ clarinet deployments apply --testnet
    ```
  </TabsContent>

  <TabsContent value="red principal" className="mt-4">
    :::callout
    type: warn

    ### Lista de verificaci√≥n de la red principal

    Antes de implementar en la red principal:

    1. Completar pruebas exhaustivas en la red de pruebas
    2. Audite sus contratos para detectar vulnerabilidades de seguridad
    3. Aseg√∫rate de tener suficiente STX para las tarifas de implementaci√≥n
    4. Haga una copia de seguridad de sus claves de implementaci√≥n de forma segura
    5. Considere usar una billetera de hardware para el despliegue
    :::

    **Generar plan de despliegue de red principal**:

    ```terminal
    $ clarinet deployments generate --mainnet --high-cost
    ```

    **Desplegar con confirmaci√≥n**:

    ```terminal
    $ clarinet deployments apply --mainnet
    ```
  </TabsContent>
</Tabs>

## Estimaci√≥n y optimizaci√≥n de costos

### Niveles de tarifas

Elija el nivel de tarifa adecuado para su implementaci√≥n:

```terminal
$ clarinet deployments generate --testnet --manual-cost
```

Opciones de nivel de tarifa:

* `--low-cost`: Minimizar comisiones, confirmaci√≥n m√°s lenta
* `--medium-cost`: Tarifas y velocidad equilibradas
* `--high-cost`: Inclusi√≥n prioritaria
* `--manual-cost`: Elegir interactivamente

### Analizando los costos de implementaci√≥n

Obtenga un desglose detallado de costos antes de implementar:

```terminal
$ clarinet deployments generate --testnet --medium-cost
```

## Configuraciones avanzadas de implementaci√≥n

### Despliegues de m√∫ltiples lotes

Despliegue sistemas complejos con dependencias utilizando lotes:

```yaml deployments/defi-protocol.yaml
plan:
  batches:
    - id: 0
      transactions:
        - contract-publish:
            contract-name: trait-definitions
            path: contracts/traits.clar
            clarity-version: 2
    - id: 1
      transactions:
        - contract-publish:
            contract-name: token
            path: contracts/token.clar
        - contract-publish:
            contract-name: oracle
            path: contracts/oracle.clar
    - id: 2
      transactions:
        - contract-publish:
            contract-name: defi-pool
            path: contracts/defi-pool.clar
```

Los lotes garantizan:

* Las dependencias se implementan primero
* Despliegue paralelo dentro de lotes
* Ejecuci√≥n secuencial entre lotes

### Tipos de transacciones

Los planes de implementaci√≥n admiten varios tipos de transacciones:

| Transaction Type   | Descripci√≥n                                                                                |
|--------------------|--------------------------------------------------------------------------------------------|
| Contract Operations| Implica publicar y llamar contratos, especificando remitente, costo y ruta                 |
| Asset Transfers    | Transfiere activos como STX o BTC, especificando remitente, destinatario y cantidades      |

**Con operaciones de contrato**:

```yaml
- contract-publish:
    contract-name: my-contract
    expected-sender: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM
    cost: 5960
    path: contracts/my-contract.clar
    clarity-version: 2

- contract-call:
    contract-id: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM.my-contract
    expected-sender: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM
    method: initialize
    parameters:
      - u1000000
      - "Token Name"
    cost: 5960
```

**Con transferencias de activos**:

```yaml
- stx-transfer:
    expected-sender: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM
    recipient: ST2CY5V39NHDPWSXMW9QDT3HC3GD6Q6XX4CFRK9AG
    mstx-amount: 1000000
    memo: '0x48656c6c6f'  # "Hello" in hex

- btc-transfer:
    expected-sender: mjSrB3wS4xab3kYqFktwBzfTdPg367ZJ2d
    recipient: bcrt1qnxknq3wqtphv7sfwy07m7e4sr6ut9yt6ed99jg
    sats-amount: 100000000
    sats-per-byte: 10
```

### Personalizaci√≥n manual del plan

Puede editar manualmente los planes de implementaci√≥n para escenarios complejos:

:::callout
### Ediciones manuales

Al implementar, Clarinet solicita sobrescribir los cambios manuales. Escriba `no` para mantener tus personalizaciones.
:::

**Ejemplo de inicializaci√≥n de contrato**:

```yaml
- id: 3
  transactions:
    - contract-call:
        contract-id: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM.token
        method: initialize
        parameters:
          - u1000000  # Initial supply
          - { name: "My Token", symbol: "MTK", decimals: u6 }
        expected-sender: ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM
```

## Problemas comunes

<Accordion type="single" collapsible>
  <AccordionItem value="saldo-insuficiente">
    <AccordionTrigger>Saldo de STX insuficiente</AccordionTrigger>

    <AccordionContent>
      <div className="pb-4 pt-2">
        **Error**: "Saldo de STX insuficiente para el despliegue"

        **Soluciones**:

        1. **Obtener STX de testnet**: Visita el [faucet de testnet](https://explorer.hiro.so/sandbox/faucet?chain=testnet)
        2. **Reducir la tasa de comisi√≥n**: Usar `--low-cost` opci√≥n
        3. **Consultar saldo**:

        ```terminal
        $ clarinet console --testnet
        >> stx-account 'ST2CY5V39NHDPWSXMW9QDT3HC3GD6Q6XX4CFRK9AG
        ```
      </div>
    </AccordionContent>
  </AccordionItem>

  <AccordionItem value="contrato-existe">
    <AccordionTrigger>El contrato ya existe</AccordionTrigger>

    <AccordionContent>
      <div className="pb-4 pt-2">
        **Error**: "Contrato 'token' ya desplegado en esta direcci√≥n"

        **Causas**:

        * Contrato con el mismo nombre ya desplegado
        * Intento de implementaci√≥n anterior exitoso

        **Soluciones**:

        1. Utilice un nombre de contrato diferente
        2. Desplegar desde una direcci√≥n diferente
        3. Si est√° realizando pruebas, utilice una cuenta nueva de testnet
      </div>
    </AccordionContent>
  </AccordionItem>

  <AccordionItem value="problemas-de-red">
    <AccordionTrigger>Fallos de conexi√≥n de red</AccordionTrigger>

    <AccordionContent>
      <div className="pb-4 pt-2">
        **Error**: "No se pudo conectar al nodo de testnet"

        **Comprobar la configuraci√≥n de red**:

        ```toml settings/Testnet.toml
        [network]
        name = "testnet"
        node_rpc_address = "https://stacks-node-api.testnet.stacks.co"
        ```

        **Probar puntos finales alternativos**:

        * Hiro: `https://api.testnet.hiro.so`
        * Usa tu propio nodo

        **Depurar conexi√≥n**:

        ```terminal
        $ curl -I https://api.testnet.hiro.so/v2/info
        ```
      </div>
    </AccordionContent>
  </AccordionItem>

  <AccordionItem value="plan-de-implementaci√≥n-errores">
    <AccordionTrigger>Plan de despliegue no v√°lido</AccordionTrigger>

    <AccordionContent>
      <div className="pb-4 pt-2">
        **Errores comunes de YAML**:

        * Sangr√≠a incorrecta
        * Faltan campos obligatorios
        * Rutas de contrato inv√°lidas

        **Valide su plan**:

        ```terminal
        $ clarinet deployments check
        ```

        **Regenerar si es necesario**:

        ```terminal
        $ clarinet deployments generate --testnet
        ```

        **Verificar que existan las rutas de los contratos**:

        ```terminal
        $ ls contracts/
        ```
      </div>
    </AccordionContent>
  </AccordionItem>
</Accordion>

## Pr√≥ximos pasos

:::next-steps
* [Chainhook](/tools/chainhook): Aprende c√≥mo monitorear tus contratos con Chainhook.
* [Monitoreo de contratos](/tools/contract-monitoring): Aprende c√≥mo monitorear tus contratos con Chainhook.
:::
