---
title: SDK de JavaScript para Clarinet
sidebarTitle: Introducción
description: Guía práctica para probar contratos inteligentes con el SDK JS de Clarinet
type: concept
---
import { File, Folder, Files } from 'fumadocs-ui/components/files';

El SDK de Clarinet JS proporciona un potente marco de pruebas para contratos inteligentes de Clarity. Se integra perfectamente con Vitest para permitir pruebas exhaustivas de la lógica de tu contrato en un entorno simulado.

## Configuración inicial

Comience creando un nuevo proyecto de Node.js o utilizando uno existente:

```package-install
$ init -y
```

Instale el SDK de Clarinet JS y las dependencias requeridas:

```package-install
@hirosystems/clarinet-sdk vitest @stacks/transactions
```

## Estructura del proyecto

Crea la siguiente estructura para tus pruebas de contratos inteligentes:

<Files className="font-fono pointer-events-none bg-background">
  <Folder name="my-project" defaultOpen>
    <Folder name="contracts" defaultOpen>
      <File name="counter.clar" />
    </Folder>

    <Folder name="tests" defaultOpen>
      <File name="counter.test.ts" />
    </Folder>

    <File name="Clarinet.toml" />

    <File name="package.json" />

    <File name="tsconfig.json" />

    <File name="vitest.config.js" />
  </Folder>
</Files>

## Prueba simple

Crea un archivo de prueba simple para verificar que tu contrato funciona:

```ts tests/counter.test.ts
import { describe, expect, it } from "vitest";
import { Cl } from "@stacks/transactions";

const accounts = simnet.getAccounts();
const wallet = accounts.get("wallet_1")!;

describe("counter contract", () => {
  it("increments the count", () => {
    const countUpCall = simnet.callPublicFn("counter", "count-up", [], wallet);
    expect(countUpCall.result).toBeOk(Cl.bool(true));
  });
});
```

El `simnet` El objeto está disponible automáticamente en tus pruebas y proporciona un entorno simulado de la cadena de bloques de Stacks.

## Opciones de configuración

### Configuración de Clarinet

Crear un `Clarinet.toml` archivo para definir tus contratos:

```toml Clarinet.toml
[project]
name = "my-project"

[contracts.counter]
path = "contracts/counter.clar"
```

### Configuración de TypeScript

Configurar TypeScript para el SDK:

```json tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "types": ["vitest/globals"]
  },
  "include": ["tests/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### Configuración de Vitest

Configura Vitest para que funcione con el SDK:

```js vitest.config.js
import { defineConfig } from "vitest/config";
import { vitestSetupFilePath } from "@hirosystems/clarinet-sdk/vitest";

export default defineConfig({
  test: {
    environment: "node",
    globals: true,
    setupFiles: [vitestSetupFilePath],
  },
});
```

:::callout
type: warn

### Importante

El `vitestSetupFilePath` debe ser incluido en su `setupFiles` matriz para que el SDK funcione correctamente.
:::

### Scripts de paquete

Añade scripts de prueba a tu `package.json`:

```json package.json
"scripts": {
  "test": "vitest run",
  "test:watch": "vitest",
  "test:coverage": "vitest run --coverage"
}
```

## Patrones comunes

### Probando funciones de solo lectura

Cuando se prueban funciones que no modifican el estado, use `callReadOnlyFn`:

```ts
const getCountCall = simnet.callReadOnlyFn(
  "counter",
  "get-count",
  [Cl.principal(wallet)],
  wallet
);
expect(getCountCall.result).toBeUint(1);
```

### Probando funciones públicas con parámetros

Pasa parámetros utilizando los ayudantes de tipo Clarity apropiados:

```ts
const depositCall = simnet.callPublicFn(
  "defi",
  "deposit",
  [Cl.uint(1000)], // Convert JS number to Clarity uint
  wallet
);
expect(depositCall.result).toBeOk(Cl.bool(true));
```

### Accediendo al estado del contrato

Verificar variables de datos y mapas directamente:

```ts
// Get a data variable
const totalDeposits = simnet.getDataVar("defi", "total-deposits");
expect(totalDeposits).toBeUint(1000);

// Get a map entry
const balance = simnet.getMapEntry("defi", "balances", Cl.principal(wallet));
expect(balance).toBeUint(1000);
```

## Ejemplos

### Probando el despliegue de contratos

Asegúrese de que su contrato esté correctamente desplegado antes de probar sus funciones:

```ts
it("ensures the contract is deployed", () => {
  const contractSource = simnet.getContractSource("counter");
  expect(contractSource).toBeDefined();
});
```

### Probando condiciones de error

Verifique que su contrato maneje los errores correctamente:

```ts
it("fails when borrowing too much", () => {
  const borrowCall = simnet.callPublicFn(
    "defi",
    "borrow",
    [Cl.uint(10000)], // Amount exceeds allowed
    wallet
  );
  expect(borrowCall.result).toBeErr(Cl.uint(300)); // err-overborrow
});
```

### Pruebas con múltiples cuentas

Simular interacciones entre diferentes usuarios:

```ts
const wallet1 = accounts.get("wallet_1")!;
const wallet2 = accounts.get("wallet_2")!;

// Wallet 1 deposits
simnet.callPublicFn("defi", "deposit", [Cl.uint(1000)], wallet1);

// Wallet 2 tries to withdraw wallet 1's funds (should fail)
const withdrawCall = simnet.callPublicFn(
  "defi",
  "withdraw",
  [Cl.uint(1000)],
  wallet2
);
expect(withdrawCall.result).toBeErr(Cl.uint(401)); // err-unauthorized
```

## Ejecutando pruebas

Ejecute su conjunto de pruebas:

```terminal
$ npm test
```

Generar informes de cobertura:

```terminal
$ npm run test:coverage
```

Esto crea un análisis detallado de cobertura y costos para las funciones de tu contrato.

## Uso avanzado

### Uso del SDK en proyectos existentes

Si tienes un proyecto existente de JavaScript/TypeScript con una estructura personalizada, aún puedes utilizar el SDK:

<Files className="font-fono pointer-events-none bg-background">
  <Folder name="my-app" defaultOpen>
    <Folder name="blockchain" defaultOpen>
      <Folder name="contracts">
        <File name="token.clar" />
      </Folder>

      <Folder name="tests">
        <File name="token.test.ts" />
      </Folder>

      <File name="Clarinet.toml" />
    </Folder>

    <Folder name="frontend">
      <File name="App.tsx" />
    </Folder>

    <File name="package.json" />

    <File name="vitest.config.js" />
  </Folder>
</Files>

Especifique la ubicación de Clarinet.toml en su configuración de Vitest:

```js vitest.config.js
export default defineConfig({
  test: {
    environment: "node",
    globals: true,
    setupFiles: [vitestSetupFilePath],
    env: {
      CLARINET_MANIFEST_PATH: "./blockchain/Clarinet.toml"
    }
  },
});
```

## Próximos pasos

:::next-steps
* [Pruebas unitarias](/tools/clarinet/unit-testing): Aprende cómo probar tu contrato con pruebas unitarias.
* [Referencia del SDK](/tools/clarinet/sdk-reference): Aprende más sobre el SDK de JS de Clarinet.
:::
