---
title: Registrar Chainhooks en devnet
sidebarTitle: Integración de Chainhook
description: En esta guía, aprenderás cómo registrar Chainhooks en devnet para monitorear y reaccionar a eventos de contratos inteligentes durante el desarrollo local.
---
## Lo que aprenderás

:::objectives
* Crear archivos de predicado Chainhook para monitoreo de eventos
* Registrar Chainhooks con Clarinet devnet
* Monitorear llamadas de contrato y eventos de blockchain
* Configurar webhooks para notificaciones en tiempo real
:::

## Requisitos previos

:::prerequisites
* Se requiere Clarinet versión 2.1.0 o superior. Verificar con `clarinet --version`.
* Se requiere Node.js versión 16 o superior. Verifique con `node --version`.
:::

## Inicio rápido

<Steps>
  <Step>
    ### Crea tus predicados de Chainhook

    Crea archivos de predicado Chainhook en la raíz de tu proyecto o en una carpeta dedicada:

    <Files className="font-fono pointer-events-none bg-background">
      <Folder name="contracts" defaultOpen>
        <File name="counter.clar" />
      </Folder>

      <Folder name="chainhooks" defaultOpen className="bg-border/50 rounded-md">
        <File name="increment.json" />

        <File name="decrement.json" />
      </Folder>

      <Folder name="tests">
        <File name="counter.test.ts" />
      </Folder>

      <File name="Clarinet.toml" />
    </Files>

    Ejemplo de predicado para monitorear eventos de incremento:

    ```json chainhooks/increment.json
    {
      "chain": "stacks",
      "uuid": "increment-hook",
      "name": "Increment Counter Hook",
      "version": 1,
      "networks": {
        "devnet": {
          "if_this": {
            "scope": "contract_call",
            "contract_identifier": "ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM.counter",
            "method": "increment"
          },
          "then_that": {
            "http_post": {
              "url": "http://localhost:3000/api/increment",
              "authorization_header": "Bearer my-secret"
            }
          }
        }
      }
    }
    ```
  </Step>

  <Step>
    ### Iniciar devnet con Chainhooks

    Inicie devnet desde la raíz de su proyecto. Clarinet registra automáticamente todos los archivos Chainhook:

    ```terminal
    $ clarinet devnet start
    ```

    Busque la confirmación de registro:

    ```terminal
    $ clarinet devnet start
    # ...
    INFO Feb  5 15:20:07.233382 2 chainhooks registered
    ```
  </Step>

  <Step>
    ### Monitorear la actividad de Chainhook

    Cuando se producen acciones de contrato, verás los disparadores de Chainhook en la terminal:

    ```terminal
    $ clarinet devnet start
    # ...
    INFO Feb  5 15:21:07.233382 1 hooks triggered
    ```

    Verifique la carga útil según su `then_that` configuration:

    * **`http_post`** - Verifica que tu endpoint haya recibido la solicitud POST
    * **`file_append`** - Verificar que el archivo fue creado/actualizado
  </Step>
</Steps>

## Patrones comunes

### Gancho de despliegue de contrato

Monitorear cuándo se implementan contratos específicos:

```json chainhooks/deploy-monitor.json
{
  "chain": "stacks",
  "uuid": "deploy-hook",
  "name": "Contract Deploy Monitor",
  "version": 1,
  "networks": {
    "devnet": {
      "if_this": {
        "scope": "contract_deployment",
        "deployer": "ST1PQHQKV0RJXZFY1DGX8MNSNYVE3VGZJSRTPGZGM"
      },
      "then_that": {
        "file_append": {
          "path": "./deployments.log"
        }
      }
    }
  }
}
```

### Monitoreo de transferencias STX

Rastrea las transferencias de STX por encima de un cierto umbral:

```json chainhooks/stx-transfers.json
{
  "chain": "stacks",
  "uuid": "stx-transfer-hook",
  "name": "Large STX Transfer Monitor",
  "version": 1,
  "networks": {
    "devnet": {
      "if_this": {
        "scope": "stx_event",
        "actions": ["transfer"],
        "amount_upper_bound": "1000000000000"
      },
      "then_that": {
        "http_post": {
          "url": "http://localhost:3000/api/large-transfer"
        }
      }
    }
  }
}
```
